## Last Session: Integrate brief injection into session loop pre-session step (simple-agent-harness-2pg)

### Completed
- Added `generate_brief(db_path) -> Result<String, String>` to `src/brief.rs` returning brief text as a string
- Refactored `handle_brief` to use `generate_brief` internally (no behavior change for CLI)
- Modified `prompt::assemble` to accept `output_dir` parameter and auto-inject brief
- Assembly sequence: prepend_commands output → brief from blacksmith.db → prompt file content
- Brief is silently skipped when no DB exists (first run) or DB has no improvements
- Brief generation errors are logged as warnings and skipped (non-fatal)
- Updated call site in `runner.rs` to pass `config.session.output_dir`
- Updated all 12 existing prompt tests to pass output_dir
- Added 4 new tests: no DB skips brief, empty DB skips brief, brief after prepend, brief without prepend
- All 187 tests pass, clippy clean (only pre-existing dead_code warnings), fmt applied

### Current State
- Brief injection is fully integrated into the session loop prompt assembly
- The brief appears between prepend_commands output and the prompt file content, separated by `\n---\n`
- Pre-existing dead_code warnings remain for unimplemented features

### Suggested Next Tasks
- Create events and observations tables (cl6) — P1, ready
- Add quantitative metrics summary to brief command output (pcb) — P2, now unblocked
- Implement improve show/update/promote/dismiss/search commands (v25) — P2, ready
